import java.util.zip.Deflater;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;


public class Compression {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}

	public IntWritable compress(Text field) {
		
		Deflater compressor = new Deflater(Deflater.BEST_COMPRESSION);
		byte[] input = field.getBytes();
		
		compressor.setInput(input); //input data to be compressed
		compressor.finish(); // done reading in data
		
		IntWritable compressed = new IntWritable(read(compressor));   // compress data
		compressor.end();   //compression process is over
		
		return compressed;
			
	}
	
	public int read(Deflater fileToCompress) {
		
		byte[] readbuffer = new byte[1024];
		int readCount = 0;
		
		while(!fileToCompress.finished())
			readCount = fileToCompress.deflate(readbuffer);
		
		return readCount;
	}
	
}
